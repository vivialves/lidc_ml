

==== Training started at 2025-07-06 12:08:51.274915 ====

Using Gradient Accumulation with 4 steps.
DataLoader batch size: 1
Effective batch size: 4

Epoch 1/50
Train Loss: 0.7223 | Train Acc: 37.63%
Val Loss: 0.6934 | Val Acc: 46.88%
Precision: 0.2344 | Recall: 0.5000 | F1 Score: 0.3191
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 1: 64
Label distribution in training epoch: Counter({0: 50, 1: 43})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 2/50
Train Loss: 0.7135 | Train Acc: 43.01%
Val Loss: 0.6931 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 2: 59
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 3/50
Train Loss: 0.6997 | Train Acc: 53.76%
Val Loss: 0.6920 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 3: 56
Label distribution in training epoch: Counter({0: 55, 1: 38})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 4/50
Train Loss: 0.7027 | Train Acc: 51.61%
Val Loss: 0.6860 | Val Acc: 68.75%
Precision: 0.3438 | Recall: 0.5000 | F1 Score: 0.4074
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 4: 64
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 5/50
Train Loss: 0.7101 | Train Acc: 47.31%
Val Loss: 0.6915 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 5: 61
Label distribution in training epoch: Counter({1: 55, 0: 38})

Validation loss did not improve. Patience: 1/6

Epoch 6/50
Train Loss: 0.6940 | Train Acc: 51.61%
Val Loss: 0.6897 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 6: 56
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss did not improve. Patience: 2/6

Epoch 7/50
Train Loss: 0.6785 | Train Acc: 56.99%
Val Loss: 0.6812 | Val Acc: 68.75%
Precision: 0.3438 | Recall: 0.5000 | F1 Score: 0.4074
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 7: 55
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 8/50
Train Loss: 0.7010 | Train Acc: 53.76%
Val Loss: 0.6932 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 8: 54
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss did not improve. Patience: 1/6

Epoch 9/50
Train Loss: 0.7049 | Train Acc: 50.54%
Val Loss: 0.7015 | Val Acc: 31.25%
Precision: 0.1667 | Recall: 0.4167 | F1 Score: 0.2381
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 9: 57
Label distribution in training epoch: Counter({1: 53, 0: 40})

Validation loss did not improve. Patience: 2/6

Epoch 10/50
Train Loss: 0.7016 | Train Acc: 49.46%
Val Loss: 0.7157 | Val Acc: 43.75%
Precision: 0.2593 | Recall: 0.3684 | F1 Score: 0.3043
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 10: 60
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss did not improve. Patience: 3/6

Epoch 11/50
Train Loss: 0.7082 | Train Acc: 45.16%
Val Loss: 0.6811 | Val Acc: 59.38%
Precision: 0.6218 | Recall: 0.5745 | F1 Score: 0.5393
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 11: 64
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 12/50
Train Loss: 0.6993 | Train Acc: 53.76%
Val Loss: 1.5173 | Val Acc: 53.12%
Precision: 0.5357 | Recall: 0.5353 | F1 Score: 0.5308
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 12: 62
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss did not improve. Patience: 1/6

Epoch 13/50
Train Loss: 0.7222 | Train Acc: 38.71%
Val Loss: 0.6128 | Val Acc: 46.88%
Precision: 0.2586 | Recall: 0.4167 | F1 Score: 0.3191
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 13: 57
Label distribution in training epoch: Counter({0: 52, 1: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth

Epoch 14/50
Train Loss: 0.7255 | Train Acc: 34.41%
Val Loss: 0.7084 | Val Acc: 50.00%
Precision: 0.5641 | Recall: 0.5397 | F1 Score: 0.4667
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 14: 55
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss did not improve. Patience: 1/6

Epoch 15/50
Train Loss: 0.7066 | Train Acc: 46.24%
Val Loss: 0.7389 | Val Acc: 34.38%
Precision: 0.2708 | Recall: 0.3275 | F1 Score: 0.2874
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 15: 61
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss did not improve. Patience: 2/6

Epoch 16/50
Train Loss: 0.6835 | Train Acc: 53.76%
Val Loss: 0.7757 | Val Acc: 68.75%
Precision: 0.6473 | Recall: 0.6320 | F1 Score: 0.6364
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 16: 63
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss did not improve. Patience: 3/6

Epoch 17/50
Train Loss: 0.6950 | Train Acc: 52.69%
Val Loss: 1.3663 | Val Acc: 59.38%
Precision: 0.5913 | Recall: 0.5902 | F1 Score: 0.5901
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 17: 58
Label distribution in training epoch: Counter({1: 55, 0: 38})

Validation loss did not improve. Patience: 4/6

Epoch 18/50
Train Loss: 0.7063 | Train Acc: 48.39%
Val Loss: 1.4393 | Val Acc: 56.25%
Precision: 0.5725 | Recall: 0.5801 | F1 Score: 0.5556
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 18: 56
Label distribution in training epoch: Counter({1: 50, 0: 43})

Validation loss did not improve. Patience: 5/6

Epoch 19/50
Train Loss: 0.7164 | Train Acc: 46.24%
Val Loss: 1.6866 | Val Acc: 53.12%
Precision: 0.5357 | Recall: 0.5353 | F1 Score: 0.5308
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 19: 61
Label distribution in training epoch: Counter({0: 47, 1: 46})

Validation loss did not improve. Patience: 6/6

Early stopping triggered after 19 epochs.


Training complete.
Loading best model from /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_efficientnet_pytorch3D_architecture.pth for final metrics.
######## Training Finished in 0h 9m 22s ###########
Test Accuracy on 32 images: 65.62%
AUC: 0.4549
Class 0-non-cancer: Precision: 0.50, Recall: 0.88, F1-Score: 0.64
Class 1-cancer: Precision: 0.00, Recall: 0.00, F1-Score: 0.00
