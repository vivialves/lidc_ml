

==== Training started at 2025-06-30 16:10:32.178946 ====

Using Gradient Accumulation with 4 steps.
DataLoader batch size: 1
Effective batch size: 4

Epoch 1/50
Train Loss: 6.4529 | Train Acc: 40.86%
Val Loss: 6.3257 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 1: 59
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 2/50
Train Loss: 6.2710 | Train Acc: 39.78%
Val Loss: 6.1023 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 2: 58
Label distribution in training epoch: Counter({0: 51, 1: 42})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 3/50
Train Loss: 6.0173 | Train Acc: 43.01%
Val Loss: 5.9965 | Val Acc: 50.00%
Precision: 0.7143 | Recall: 0.6000 | F1 Score: 0.4667
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 3: 58
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 4/50
Train Loss: 5.8303 | Train Acc: 47.31%
Val Loss: 5.6512 | Val Acc: 68.75%
Precision: 0.7486 | Recall: 0.6706 | F1 Score: 0.6537
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 4: 57
Label distribution in training epoch: Counter({0: 54, 1: 39})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 5/50
Train Loss: 5.5801 | Train Acc: 36.56%
Val Loss: 5.5654 | Val Acc: 50.00%
Precision: 0.6282 | Recall: 0.5833 | F1 Score: 0.4818
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 5: 52
Label distribution in training epoch: Counter({0: 51, 1: 42})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 6/50
Train Loss: 5.5625 | Train Acc: 34.41%
Val Loss: 4.9730 | Val Acc: 46.88%
Precision: 0.2344 | Recall: 0.5000 | F1 Score: 0.3191
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 6: 62
Label distribution in training epoch: Counter({1: 51, 0: 42})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 7/50
Train Loss: 5.1590 | Train Acc: 44.09%
Val Loss: 5.0938 | Val Acc: 59.38%
Precision: 0.5821 | Recall: 0.5675 | F1 Score: 0.5589
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 7: 63
Label distribution in training epoch: Counter({1: 47, 0: 46})

Validation loss did not improve. Patience: 1/5

Epoch 8/50
Train Loss: 5.0581 | Train Acc: 39.78%
Val Loss: 4.8646 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 8: 55
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 9/50
Train Loss: 4.7526 | Train Acc: 43.01%
Val Loss: 4.7278 | Val Acc: 53.12%
Precision: 0.5227 | Recall: 0.5196 | F1 Score: 0.5077
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 9: 59
Label distribution in training epoch: Counter({0: 51, 1: 42})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 10/50
Train Loss: 4.8915 | Train Acc: 33.33%
Val Loss: 4.5619 | Val Acc: 56.25%
Precision: 0.5942 | Recall: 0.5765 | F1 Score: 0.5466
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 10: 58
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 11/50
Train Loss: 4.2987 | Train Acc: 47.31%
Val Loss: 4.6920 | Val Acc: 50.00%
Precision: 0.4493 | Recall: 0.4575 | F1 Score: 0.4459
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 11: 55
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss did not improve. Patience: 1/5

Epoch 12/50
Train Loss: 4.2881 | Train Acc: 44.09%
Val Loss: 4.0411 | Val Acc: 71.88%
Precision: 0.3594 | Recall: 0.5000 | F1 Score: 0.4182
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 12: 59
Label distribution in training epoch: Counter({0: 52, 1: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 13/50
Train Loss: 4.1786 | Train Acc: 38.71%
Val Loss: 3.8908 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 13: 55
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 14/50
Train Loss: 4.2599 | Train Acc: 31.18%
Val Loss: 3.7513 | Val Acc: 59.38%
Precision: 0.2969 | Recall: 0.5000 | F1 Score: 0.3725
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 14: 59
Label distribution in training epoch: Counter({0: 53, 1: 40})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 15/50
Train Loss: 3.8004 | Train Acc: 47.31%
Val Loss: 3.6655 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 15: 55
Label distribution in training epoch: Counter({1: 50, 0: 43})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 16/50
Train Loss: 3.8746 | Train Acc: 41.94%
Val Loss: 3.8689 | Val Acc: 37.50%
Precision: 0.1875 | Recall: 0.5000 | F1 Score: 0.2727
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 16: 51
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss did not improve. Patience: 1/5

Epoch 17/50
Train Loss: 3.8458 | Train Acc: 39.78%
Val Loss: 3.4075 | Val Acc: 46.88%
Precision: 0.2344 | Recall: 0.5000 | F1 Score: 0.3191
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 17: 63
Label distribution in training epoch: Counter({1: 50, 0: 43})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 18/50
Train Loss: 3.9460 | Train Acc: 34.41%
Val Loss: 3.7827 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 18: 62
Label distribution in training epoch: Counter({0: 49, 1: 44})

Validation loss did not improve. Patience: 1/5

Epoch 19/50
Train Loss: 3.6598 | Train Acc: 40.86%
Val Loss: 3.2391 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 19: 63
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 20/50
Train Loss: 3.1487 | Train Acc: 40.86%
Val Loss: 2.8674 | Val Acc: 46.88%
Precision: 0.2344 | Recall: 0.5000 | F1 Score: 0.3191
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 20: 53
Label distribution in training epoch: Counter({0: 50, 1: 43})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 21/50
Train Loss: 2.9560 | Train Acc: 46.24%
Val Loss: 2.8151 | Val Acc: 37.50%
Precision: 0.1875 | Recall: 0.5000 | F1 Score: 0.2727
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 21: 55
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 22/50
Train Loss: 2.9808 | Train Acc: 49.46%
Val Loss: 3.9090 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 22: 55
Label distribution in training epoch: Counter({0: 48, 1: 45})

Validation loss did not improve. Patience: 1/5

Epoch 23/50
Train Loss: 3.3308 | Train Acc: 46.24%
Val Loss: 2.6979 | Val Acc: 65.62%
Precision: 0.5519 | Recall: 0.5318 | F1 Score: 0.5211
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 23: 53
Label distribution in training epoch: Counter({0: 53, 1: 40})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 24/50
Train Loss: 3.0127 | Train Acc: 47.31%
Val Loss: 2.6698 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 24: 55
Label distribution in training epoch: Counter({1: 48, 0: 45})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth

Epoch 25/50
Train Loss: 3.5775 | Train Acc: 36.56%
Val Loss: 2.7474 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 25: 58
Label distribution in training epoch: Counter({0: 49, 1: 44})

Validation loss did not improve. Patience: 1/5

Epoch 26/50
Train Loss: 3.4739 | Train Acc: 43.01%
Val Loss: 3.8406 | Val Acc: 65.62%
Precision: 0.8226 | Recall: 0.5417 | F1 Score: 0.4691
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 26: 54
Label distribution in training epoch: Counter({1: 49, 0: 44})

Validation loss did not improve. Patience: 2/5

Epoch 27/50
Train Loss: 2.6939 | Train Acc: 44.09%
Val Loss: 2.8633 | Val Acc: 53.12%
Precision: 0.6250 | Recall: 0.5549 | F1 Score: 0.4684
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 27: 63
Label distribution in training epoch: Counter({1: 50, 0: 43})

Validation loss did not improve. Patience: 3/5

Epoch 28/50
Train Loss: 3.8481 | Train Acc: 40.86%
Val Loss: 3.3395 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 28: 56
Label distribution in training epoch: Counter({0: 50, 1: 43})

Validation loss did not improve. Patience: 4/5

Epoch 29/50
Train Loss: 3.3207 | Train Acc: 48.39%
Val Loss: 2.7852 | Val Acc: 56.25%
Precision: 0.6667 | Recall: 0.6032 | F1 Score: 0.5333
Current AMP scale: 32768.0
Unique augmented volumes seen in epoch 29: 55
Label distribution in training epoch: Counter({0: 58, 1: 35})

Validation loss did not improve. Patience: 5/5

Early stopping triggered after 29 epochs.


Training complete.
Loading best model from /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_densenet_pytorch3D_architecture.pth for final metrics.
######## Training Finished in 0h 9m 22s ###########
Test Accuracy on 32 images: 59.38%
AUC: 0.4078
Class 0-non-cancer: Precision: 0.00, Recall: 0.00, F1-Score: 0.00
Class 1-cancer: Precision: 0.50, Recall: 1.00, F1-Score: 0.67
