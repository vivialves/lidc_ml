

==== Training started at 2025-06-23 18:12:03.890302 ====

Using Gradient Accumulation with 4 steps.
DataLoader batch size: 1
Effective batch size: 4

Epoch 1/50
Train Loss: 1.3516 | Train Acc: 46.24%
Val Loss: 10.6543 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 1: 54
Label distribution in training epoch: Counter({0: 52, 1: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_resnet_pytorch3D_architecture_v0.pth

Epoch 2/50
Train Loss: 0.8199 | Train Acc: 47.31%
Val Loss: 0.7050 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 2: 62
Label distribution in training epoch: Counter({0: 51, 1: 42})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_resnet_pytorch3D_architecture_v0.pth

Epoch 3/50
Train Loss: 0.7185 | Train Acc: 50.54%
Val Loss: 0.9872 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 3: 57
Label distribution in training epoch: Counter({0: 47, 1: 46})

Validation loss did not improve. Patience: 1/6

Epoch 4/50
Train Loss: 0.7126 | Train Acc: 49.46%
Val Loss: 0.6699 | Val Acc: 56.25%
Precision: 0.2812 | Recall: 0.5000 | F1 Score: 0.3600
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 4: 60
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_resnet_pytorch3D_architecture_v0.pth

Epoch 5/50
Train Loss: 0.7067 | Train Acc: 45.16%
Val Loss: 0.6897 | Val Acc: 59.38%
Precision: 0.2969 | Recall: 0.5000 | F1 Score: 0.3725
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 5: 60
Label distribution in training epoch: Counter({1: 47, 0: 46})

Validation loss did not improve. Patience: 1/6

Epoch 6/50
Train Loss: 0.7051 | Train Acc: 50.54%
Val Loss: 0.6853 | Val Acc: 50.00%
Precision: 0.2500 | Recall: 0.5000 | F1 Score: 0.3333
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 6: 61
Label distribution in training epoch: Counter({1: 51, 0: 42})

Validation loss did not improve. Patience: 2/6

Epoch 7/50
Train Loss: 0.6990 | Train Acc: 54.84%
Val Loss: 0.7107 | Val Acc: 75.00%
Precision: 0.3750 | Recall: 0.5000 | F1 Score: 0.4286
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 7: 60
Label distribution in training epoch: Counter({0: 49, 1: 44})

Validation loss did not improve. Patience: 3/6

Epoch 8/50
Train Loss: 0.7018 | Train Acc: 51.61%
Val Loss: 0.6170 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 8: 61
Label distribution in training epoch: Counter({1: 52, 0: 41})

Validation loss improved. Saving best model to /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_resnet_pytorch3D_architecture_v0.pth

Epoch 9/50
Train Loss: 0.7033 | Train Acc: 50.54%
Val Loss: 0.7103 | Val Acc: 59.38%
Precision: 0.2969 | Recall: 0.5000 | F1 Score: 0.3725
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 9: 54
Label distribution in training epoch: Counter({0: 53, 1: 40})

Validation loss did not improve. Patience: 1/6

Epoch 10/50
Train Loss: 0.6974 | Train Acc: 58.06%
Val Loss: 0.9764 | Val Acc: 65.62%
Precision: 0.3281 | Recall: 0.5000 | F1 Score: 0.3962
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 10: 53
Label distribution in training epoch: Counter({0: 54, 1: 39})

Validation loss did not improve. Patience: 2/6

Epoch 11/50
Train Loss: 0.7044 | Train Acc: 51.61%
Val Loss: 0.6930 | Val Acc: 46.88%
Precision: 0.2344 | Recall: 0.5000 | F1 Score: 0.3191
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 11: 59
Label distribution in training epoch: Counter({1: 50, 0: 43})

Validation loss did not improve. Patience: 3/6

Epoch 12/50
Train Loss: 0.6771 | Train Acc: 61.29%
Val Loss: 0.7014 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 12: 57
Label distribution in training epoch: Counter({0: 52, 1: 41})

Validation loss did not improve. Patience: 4/6

Epoch 13/50
Train Loss: 0.7178 | Train Acc: 49.46%
Val Loss: 0.8732 | Val Acc: 53.12%
Precision: 0.2656 | Recall: 0.5000 | F1 Score: 0.3469
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 13: 52
Label distribution in training epoch: Counter({0: 52, 1: 41})

Validation loss did not improve. Patience: 5/6

Epoch 14/50
Train Loss: 0.7113 | Train Acc: 59.14%
Val Loss: 1.8296 | Val Acc: 43.75%
Precision: 0.2188 | Recall: 0.5000 | F1 Score: 0.3043
Current AMP scale: 16384.0
Unique augmented volumes seen in epoch 14: 62
Label distribution in training epoch: Counter({1: 47, 0: 46})

Validation loss did not improve. Patience: 6/6

Early stopping triggered after 14 epochs.


Training complete.
Loading best model from /home/etudiant/Projets/Viviane/LIDC-ML/models/best_model_resnet_pytorch3D_architecture_v0.pth for final metrics.
######## Training Finished in 0h 49m 7s ###########
Test Accuracy on 32 images: 68.75%
AUC: 0.7529
Class 0-non-cancer: Precision: 0.00, Recall: 0.00, F1-Score: 0.00
Class 1-cancer: Precision: 0.41, Recall: 1.00, F1-Score: 0.58
